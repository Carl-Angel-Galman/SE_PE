\newpage
\section{Proposed Software Architecture}
\subsection{System Overview (Gesamtkontext)}

\subsubsection{Übersichtsdiagramm}
\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{diagramms/Overview.png}
  \caption{Gesamtüberblick: Systemkontext und Kommunikations-/Datenflüsse}
  \label{fig:overview_total}
\end{figure}

\subsubsection{Kurzbeschreibung}
Abbildung~\ref{fig:overview_total} ordnet die Emergency-Stop-Funktion in den Gesamtkontext ein.
Sensorik und Hardware-I/O werden auf den Truck-Knoten verarbeitet; die Bedien- und Leitsoftware (Mission Control) kommuniziert
über WLAN mit dem System. Für den Emergency Stop sind insbesondere die Button-/Schalter-Eingänge sowie die Ausgabe an Aktorik
(z.\,B. Bremsanforderung) und Signalisierung relevant.

Zusätzlich sind die internen Knoten wie folgt gekoppelt:
\begin{itemize}[leftmargin=*, itemsep=2pt]
  \item \textbf{Arduino Mega ``Master'' $\leftrightarrow$ Arduino Mega ``Slave'':} Verbindung über \textbf{CAN} zur robusten, deterministischen Kommunikation.
  \item \textbf{Jetson AGX / Arduino Mega ``Master'' / WLAN-Modul:} Anbindung über ein internes \textbf{LAN} zum \emph{WLAN Client}.
\end{itemize}

Die Hardware-Anbindung ist so verteilt, dass sicherheitskritische und zeitkritische Signale möglichst nah an der Ausführungslogik liegen:
\begin{itemize}[leftmargin=*, itemsep=2pt]
  \item \textbf{Arduino Mega ``Master'':} \emph{Soft-Stop Schalter} sowie \emph{Lichter/Signalisierung} (z.\,B. Blinklicht).
  \item \textbf{Jetson AGX:} Anbindung der \emph{zwei LiDAR-Sensoren} zur Umgebungserfassung (Input für TTC-Auswertung).
  \item \textbf{Arduino Mega ``Slave'':} \emph{Pilz-Notknopf (Notaus)} zur direkten, sicherheitskritischen Stop-Auslösung.
\end{itemize}

\subsubsection{Subsysteme im Kontext der Emergency-Stop-Funktion}
\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{diagramms/SubSystems.png}
  \caption{Aufteilung und Verbindung der Subsysteme}
  \label{fig:subsystems_context}
\end{figure}

Abbildung~\ref{fig:subsystems_context} zeigt die für den Emergency Stop relevanten Subkomponenten und deren Schnittstellen.
Der \emph{TTC-Observer} liefert Informationen/Ereignisse an \emph{Emergency Stop}. Über das \emph{EnvironmentControl Interface} werden
Eingänge (z.\,B. ButtonStates) und Ausgänge (z.\,B. LEDs/Signalisierung) angebunden. \emph{Emergency Stop} stößt Stop-Anforderungen an die
\emph{DriveControlUnit} an und erzeugt Log-Ausgaben an \emph{Logging}. Die genaue Ausgestaltung der Klassen/Interfaces wird in den
Klassendiagrammen (folgende Abschnitte) beschrieben.

% TODO: HIER Platzhalter für die Klassendiagramme einfügen (Attribute + public operations)

\subsection{Hardware/Software Mapping (Deployment)}
\label{sec:deployment}

\subsubsection{Deployment Diagram}
\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{diagramms/Deployment.png}
  \caption{Zuordnung von Subkomponenten zur Hardware}
  \label{fig:deployment}
\end{figure}

\subsubsection{Zuordnung der Komponenten}
\begin{itemize}[leftmargin=*, itemsep=2pt]
  \item \textbf{Jetson AGX:} \emph{TTC-Observer}
  \item \textbf{Arduino Mega ``Master'':} \emph{EnvironmentControl Interface}
  \item \textbf{Arduino Mega ``Slave'':} \emph{Emergency Stop}, \emph{DriveControlUnit}, \emph{Logging}
\end{itemize}

\subsubsection{Begründung der Verteilung}
\begin{itemize}[leftmargin=*, itemsep=2pt]
  \item \textbf{Arduino Mega ``Slave'':} Bündelt sicherheitskritische Funktionen. \emph{Emergency Stop} und \emph{DriveControlUnit}
        liegen gemeinsam, um Stop-Anforderungen mit geringer Latenz und ohne zusätzliche Netz-/Knotenabhängigkeiten umzusetzen.
        \emph{Logging} läuft ebenfalls dort, damit Stop-Ereignisse unmittelbar erfasst werden und auch bei Teilausfällen anderer Knoten
        nicht verloren gehen.
  \item \textbf{Arduino Mega ``Master'':} Führt das \emph{EnvironmentControl Interface} aus und kapselt die hardware-nahe I/O-Anbindung
        (z.\,B. Einlesen von Schaltern/Buttons und Ansteuerung von Signalisierung). Dadurch bleibt die sicherheitskritische Logik auf dem
        Slave von I/O-Details getrennt.
  \item \textbf{Jetson AGX:} Führt den \emph{TTC-Observer} aus. Die TTC-Auswertung ist rechenintensiver und wird auf einer leistungsfähigen
        Plattform ausgeführt; daraus resultierende Stop-Informationen werden an die sicherheitskritische Logik weitergegeben.
\end{itemize}